group_types:
  type: data
  data:
    types:
      housing:
        max_members: 6
        switches: Build|Break|Use|Containers
        has_ranks: false
        ranks: <list>

group_manager_create:
  type: task
  debug: false
  definitions: group|group_type|target
  script:
    - stop if:<script[group_types].data_key[data.types.<[group_type]>].exists.not>
    - define target <player> if:<[target].exists.not>
    - flag server groups.<[group_type]>.<[group]>.owner:<[target]>
    - define map <map>
    - foreach <script[group_types].data_key[data.types.<[group_type]>.switches]>:
      - define map <[map].with[<[value]>].as[true]>
    - flag server groups.<[group_type]>.<[group]>.members.<[target]>:<[map]>

group_manager_set_member:
  type: task
  debug: false
  definitions: group_type|group|switches_single|target
  script:
    - stop if:<server.has_flag[groups.<[group_type]>.<[group]>].not>
    - define target <player> if:<[target].exists.not>
    - flag server groups.<[group_type]>.<[group]>
    - foreach <script[group_types].data_key[data.types.<[group_type]>.switches]>:
      - if <[switches_single].contains[<[value]>]>:
        - define map <[map].with[<[value]>].as[true]>
      - else:
        - define map <[map].with[<[value]>].as[false]>
    - flag server groups.<[group_type]>.<[group]>.members.<[target]>:<[map]>

group_manager_set_switch:
  type: task
  debug: false
  definitions: group_type|group|switch|value|target
  script:
    - stop if:<script[group_types].data_key[data.types.<[group_type]>.switches].exists.not>
    - stop if:<server.has_flag[groups.<[group_type]>.<[group]>].not>
    - define target <player> if:<[target].exists.not>
    - define map <server.flag[groups.<[group_type]>.<[group]>.members.<[target]>]>
    - flag server groups.<[group_type]>.<[group]>.members.<[target]>:<[map].with[<[switch]>].as[<[value]>]>

group_manager_inventory:
  type: inventory
  debug: false
  inventory: chest
  size: 54
  data:
    drag: cancel
    any_click: cancel

group_manager_inventory_open:
  type: task
  debug: false
  script:
    - define inv <inventory[group_manager_inventory]>
